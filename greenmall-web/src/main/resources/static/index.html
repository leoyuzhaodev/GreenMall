<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>首页</title>
    <!-- 资源引入 -->
    <link href="http://www.greenmall.com/AmazeUI-2.4.2/assets/css/amazeui.css" rel="stylesheet" type="text/css"/>
    <link href="http://www.greenmall.com/AmazeUI-2.4.2/assets/css/admin.css" rel="stylesheet" type="text/css"/>
    <link href="http://www.greenmall.com/basic/css/demo.css" rel="stylesheet" type="text/css"/>
    <link href="http://www.greenmall.com/css/hmstyle.css" rel="stylesheet" type="text/css"/>
    <script src="http://www.greenmall.com/AmazeUI-2.4.2/assets/js/jquery.min.js"></script>
    <script src="http://www.greenmall.com/AmazeUI-2.4.2/assets/js/amazeui.min.js"></script>
    <script type="text/javascript " src="http://www.greenmall.com/basic/js/quick_links.js "></script>

    <!-- 引入 vue，以及相关工具js -->
    <script src="http://www.greenmall.com/js/math.js"></script>
    <script src="http://www.greenmall.com/js/vue/vue.js"></script>
    <script src="http://www.greenmall.com/js/axios.min.js"></script>
    <script src="http://www.greenmall.com/js/common.js"></script>

    <style type="text/css">
        .introduceWeb {
            color: black;
            word-wrap: break-word;
            word-break: normal;
            line-height: 30px;
            font-weight: bold;
            font-family: KaiTi;
        }
    </style>

</head>

<body>
<div id="indexApp">
    <div>
        <div>
            <div>
                <!-- 头部栏位 -->
                <div id="nav-gm">
                    <gm-top/>
                </div>

                <div class="banner">
                    <!--轮播 -->
                    <div class="am-slider am-slider-default scoll" data-am-flexslider id="demo-slider-0">
                        <ul class="am-slides">
                            <li class="banner1"><a href="introduction.html"><img src="images/lb1.jpg"/></a></li>
                            <li class="banner2"><a><img src="images/lb2.jpg"/></a></li>
                            <li class="banner3"><a><img src="images/lb3.jpg"/></a></li>
                            <li class="banner4"><a><img src="images/lb4.jpg"/></a></li>
                        </ul>
                    </div>
                    <div class="clear"></div>
                </div>

                <div class="shopNav">
                    <div class="slideall">

                        <div class="long-title"><span class="all-goods">全部分类</span></div>
                        <div class="nav-cont">
                            <ul>
                                <li class="index"><a href="javascript:void(0)">首页</a></li>
                            </ul>

                        </div>

                        <!--侧边导航 -->
                        <div id="nav" class="navfull">
                            <div class="area clearfix">
                                <div class="category-content" id="guide_2">

                                    <div class="category">
                                        <!-- 商品分类渲染 -->
                                        <ul v-if="gm.isCollectionNotEmpty(categoryTree)"
                                            class="category-list"
                                            id="js_climit_li"
                                            style="height: 430px;">
                                            <li v-for="(item1,index) in categoryTree"
                                                :key="'level1'+index"
                                                :class="{'appliance js_toggle relative': 1==1,'first': index == 0 }"
                                                @mouseover="liMouseOver($event)" @mouseout="liMouseOut($event)"
                                            >

                                                <div class="category-info">
                                                    <h3 class="category-name b-category-name"><i><img
                                                            src="images/cake.png"></i><a
                                                            class="ml-22" :title="item1.title">{{item1.title}}</a></h3>
                                                    <em>&gt;</em>
                                                </div>
                                                <div class="menu-item menu-in top">
                                                    <div class="area-in">
                                                        <div class="area-bg">
                                                            <div class="menu-srot">
                                                                <div class="sort-side">
                                                                    <dl class="dl-sort"
                                                                        v-for="(item2,index) in item1.children"
                                                                        :key="'level2'+index">
                                                                        <dt><span
                                                                                :title="item2.title">{{item2.title}}</span>
                                                                        </dt>

                                                                        <dd v-for="(item3,index) in item2.children"
                                                                            :key="'level3'+index">
                                                                            <a :title="item3.title"
                                                                               :href="'http://www.greenmall.com/search.html?cid3='+item3.id+'&categoryName='+item3.title">
                                                                                <span>{{item3.title}}</span></a>
                                                                        </dd>
                                                                    </dl>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <b class="arrow"></b>
                                            </li>
                                        </ul>
                                    </div>
                                </div>

                            </div>
                        </div>


                        <!--小导航 -->
                        <div class="am-g am-g-fixed smallnav">
                            <div class="am-u-sm-3">
                                <a href="sort.html"><img src="images/navsmall.jpg"/>
                                    <div class="title">商品分类</div>
                                </a>
                            </div>
                            <div class="am-u-sm-3">
                                <a href="#"><img src="images/huismall.jpg"/>
                                    <div class="title">大聚惠</div>
                                </a>
                            </div>
                            <div class="am-u-sm-3">
                                <a href="#"><img src="images/mansmall.jpg"/>
                                    <div class="title">个人中心</div>
                                </a>
                            </div>
                            <div class="am-u-sm-3">
                                <a href="#"><img src="images/moneysmall.jpg"/>
                                    <div class="title">投资理财</div>
                                </a>
                            </div>
                        </div>

                        <!--走马灯 -->

                        <div class="marqueen" style="opacity: 0.9">
                            <span class="marqueen-title"></span>
                            <div class="demo">

                                <ul>

                                    <div class="mod-vip">
                                        <div v-if="gm.isObjectNotEmpty(userInfo)" class="m-baseinfo">
                                            <a href="person/index.html">
                                                <img height="50px" width="50px" :src="userInfo.portrait">
                                            </a>
                                            <em>
                                                Hi,<span class="s-name">{{userInfo.nickName}}</span>
                                            </em>
                                        </div>

                                        <div v-else class="m-baseinfo">
                                            <a href="person/index.html">
                                                <img height="50px" width="50px" src="images/getAvatar.do.jpg">
                                            </a>
                                            <em>
                                                Hi,<span class="s-name">游客</span>
                                            </em>
                                        </div>

                                        <div v-if="gm.isObjectNotEmpty(userInfo) == false" class="member-logout">
                                            <a class="am-btn-warning btn" href="login.html">登录</a>
                                            <a class="am-btn-warning btn" href="register.html">注册</a>
                                        </div>

                                    </div>

                                    <p class="introduceWeb"
                                    >
                                        绿色商城：商城致力于为用户提供优质的服务，高质量的绿色产品。良心的价格，优质的商品希望得到您的青睐。
                                    </p>
                                </ul>
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>

                </div>
                <div class="shopMainbg">
                    <div class="shopMain" id="shopmain">

                        <!--今日推荐 -->
                        <div class="am-g am-g-fixed recommendation">
                            <div class="clock am-u-sm-3">
                                <img src="images/2020.png "></img>
                                <p>今日<br>推荐</p>
                            </div>

                            <div v-for="(item,index) in recommendList" :key="index+'recommend'"
                                 class="am-u-sm-4 am-u-lg-3 ">
                                <div class="info ">
                                    <h3>{{item.goodsTitle.length > 15 ? item.goodsTitle.substring(0,15) +
                                        '...': item.goodsTitle}}</h3>
                                    <span class="e-price ">￥{{gm.gmFormatPrice(item.goodsPrice)}}</span>
                                </div>
                                <div class="recommendationMain ">
                                    <a :href="'http://www.greenmall.com/goods/introduction/'+item.goodsId+'.html'"
                                       style="cursor: pointer">
                                        <img height="120px" width="120px" :src="item.goodsImage"/>
                                    </a>
                                </div>
                            </div>


                        </div>
                        <div class="clear "></div>
                        <!-- 网站新品四个 -->

                        <div class="am-container activity ">
                            <div class="shopTitle ">
                                <h4>新品</h4>
                                <h3>新品尝鲜</h3>
                                <span class="more ">
                              <a class="more-link " href="# ">商城新品</a>
                            </span>
                            </div>
                            <!-- 新品 -->
                            <div v-if="gm.isCollectionNotEmpty(newGoodsList)" class="am-g am-g-fixed ">

                                <div style="margin-top: 10px;" v-for="(item,index) in newGoodsList" :key="index+'new'"
                                     class="am-u-sm-3 ">
                                    <div class="icon-sale two "></div>
                                    <h4>新品</h4>
                                    <div class="activityMain ">
                                        <a :href="'http://www.greenmall.com/goods/introduction/'+item.goodsId+'.html'"
                                           style="cursor: pointer">
                                            <img width="296px" height="314px" :src="item.goodsImage"/>
                                        </a>
                                    </div>
                                    <div class="info ">
                                        <h3>上架时间：{{gm.renderTime(item.createTime)}}</h3>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="clear "></div>

                        <!-- 销量top12 -->
                        <div class="am-container ">
                            <div class="shopTitle ">
                                <h4>销量top12</h4>
                                <h3>大家都买的，让你更安心</h3>
                                <div class="today-brands ">

                                </div>
                                <span class="more ">
                                     <a class="more-link " href="# ">更多美味</a>
                                </span>
                            </div>
                        </div>
                        <div class="am-g am-g-fixed flood method3 ">
                            <ul v-if="gm.isCollectionNotEmpty(topSVGoods)" class="am-thumbnails ">
                                <li v-for="(item,index) in topSVGoods" :key="index+'top'">
                                    <div class="list ">
                                        <a :href="'http://www.greenmall.com/goods/introduction/'+item.goodsId+'.html'">
                                            <img width="188px" height="188px" :src="item.goodsImage"/>
                                            <div class="pro-title ">
                                                {{item.goodsTitle.length > 10 ? item.goodsTitle.substring(0,10) +
                                                '...': item.goodsTitle}}
                                            </div>
                                            <span class="e-price ">￥{{gm.gmFormatPrice(item.goodsPrice)}}</span>
                                            <br>
                                            <span class="e-price ">第&nbsp;{{item.topNumber}}&nbsp;名&nbsp;&nbsp;总销量:{{item.saleVolume}}</span>
                                        </a>
                                    </div>
                                </li>
                            </ul>

                        </div>
                        <!-- 页脚 -->
                        <gm-footer></gm-footer>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<!-- 页面自适应 -->
<script type="text/javascript">
    if ($(window).width() < 640) {
        function autoScroll(obj) {
            $(obj).find("ul").animate({
                marginTop: "-39px"
            }, 500, function () {
                $(this).css({
                    marginTop: "0px"
                }).find("li:first").appendTo(this);
            })
        }

        $(function () {
            setInterval('autoScroll(".demo")', 3000);
        })
    }
</script>

<script>
    var vm = new Vue({
        el: "#indexApp",
        data: {
            gm, // 必须引用到实例中，在html标签中才能使用
            categoryTree: [],
            flag: 1,
            userInfo: null,
            newGoodsList: [],
            topSVGoods: [],
            recommendList: []
        }, created() {
            // 1，加载分类树
            this.loadCategoryTree();
            // 2，加载用户的昵称和头像
            this.loadUserInfo();
            // 3，加载新品
            this.loadNewGoodsList();
            // 4，加载销量前12的商品
            this.loadTopSVGoods();
            // 5，加载推荐商品
            this.loadRecommendGoods();
        },
        components: {
            gmTop: () => import("http://www.greenmall.com/js/pages/top.js"),
            gmFooter: () => import("http://www.greenmall.com/js/pages/footer.js"),
        },
        watch: {},
        computed: {},
        methods: {
            /* 加载分类树 */
            loadCategoryTree() {
                gm.http.get("/category/queryCategoryTree/")
                    .then(resp => {
                        if (resp.status === 200) {
                            var data = resp.data;
                            if (gm.isCollectionNotEmpty(data)) {
                                this.categoryTree = data;
                            }
                        }
                    })
                    .catch(() => {
                        alert("加载分类树失败!")
                    })
            },
            /* liMouseOver */
            liMouseOver(event) {
                var item = event.currentTarget;
                $(".category-content .category-list li.first .menu-in").css("display", "none");
                $(".category-content .category-list li.first").removeClass("hover");
                $(item).addClass("hover");
                $(item).children("div.menu-in").css("display", "block");
            },
            /* liMouseOut */
            liMouseOut(event) {
                var item = event.currentTarget;
                $(item).removeClass("hover")
                $(item).children("div.menu-in").css("display", "none")
            },
            /* 加载用户信息 */
            loadUserInfo() {
                gm.http.get("/user/auth/loginUserInfo")
                    .then(resp => {
                        if (resp.status === 200) {
                            var data = resp.data;
                            if (gm.isObjectNotEmpty(data)) {
                                this.userInfo = data;
                            }
                        }
                    })
                    .catch(() => {

                    })
            },
            /* 加载上架的新品 */
            loadNewGoodsList() {
                gm.http.get("/goods/newGoods")
                    .then(resp => {
                        if (resp.status === 200) {
                            var data = resp.data;
                            if (gm.isCollectionNotEmpty(data)) {
                                this.newGoodsList = data;
                            }
                        }
                    })
                    .catch(() => {
                    })
            },
            /* 加载销量前12的商品 */
            loadTopSVGoods() {
                gm.http.get("/goods/queryTopSaleVolumeGoods")
                    .then(resp => {
                        if (resp.status === 200) {
                            var data = resp.data;
                            if (gm.isCollectionNotEmpty(data)) {
                                this.topSVGoods = data;
                            }
                        }
                    })
                    .catch(() => {
                    })
            },
            /* 加载推荐商品 */
            loadRecommendGoods() {
                gm.http.get("/goods/queryRecommendGoods")
                    .then(resp => {
                        if (resp.status === 200) {
                            var data = resp.data;
                            if (gm.isCollectionNotEmpty(data)) {
                                this.recommendList = data;
                            }
                        }
                    })
                    .catch(() => {
                    })
            }
        }
    });
</script>
<!--轮播 -->
<script type="text/javascript">
    (function () {
        $('.am-slider').flexslider();
    });
    $(document).ready(function () {
        $("li").hover(function () {
            $(".category-content .category-list li.first .menu-in").css("display", "none");
            $(".category-content .category-list li.first").removeClass("hover");
            $(this).addClass("hover");
            $(this).children("div.menu-in").css("display", "block")
        }, function () {
            $(this).removeClass("hover")
            $(this).children("div.menu-in").css("display", "none")
        });
    })
</script>
</html>